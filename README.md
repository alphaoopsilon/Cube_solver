# Cube_solver
This repository is attempts to find a lower dimensional subspace that best represents the shuffled state of a 2x2x2 cube.
## Dataset Description
The dataset was generated by defining a transition matrix, of the different sequence of moves in a Rubix cube. 
18 different moves were considered, F, B, R, L, U, D, their primes and duals were considered while generating the data.
Hopping from the same family or their conjugates at a given state were restricted.
Ex: (F F’), (R L’), (F2 F’)
## Pre-Training phase
The primary aim of the pre-training phase was to project the scrambled state of the cube to a lower dimensional state that captures the information of the cube.
This was achieved by feeding the input state of a cube, by feeding the the scrambled state to a binary deep belief network.
In case of a 2x2x2 cube, we have 24 squares that contain one of 6 colours encoded as a 144 dimensional vector.
An RBM with 2 layers[288, 576] was trained using 10000 randomly generated samples and every move to get to the scrambled state.

## Reinforcement Learning
The reduced state was then used by a reinforcement learning algorithm that uses approximate policy iteration as mentioned [here](https://openreview.net/forum?id=Hyfn2jCcKm)
This method is a supervised learning procedure which takes an input state ‘s’ and outputs a value and policy pair(v,p).

## Results
To reproduce the results:
Run DBN.py to train a dep belief network to capture the underlying information in the scrambled state of a cube. Once trained the parameters of the network are saved as dbn_network.sav.
Run RL_train to train the reinforcement learning model on the reduced state of the 2x2x2 cube.
Use RT_test to test or run realtime inference of a given scrambled state
